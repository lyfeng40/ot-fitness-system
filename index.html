<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>職能治療運動評估系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-slate-50 min-h-screen p-4">
    
    <!-- 導航列 -->
    <header class="bg-white rounded-2xl shadow-lg p-6 mb-8 border">
        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
            <div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2">
                    💪 職能治療運動評估系統
                </h1>
                <p class="text-slate-500 font-medium">OT Supervisor Dashboard</p>
            </div>
            <div class="flex bg-slate-100 p-2 rounded-xl space-x-2 w-full lg:w-auto">
                <button onclick="showView('dashboard')" class="px-6 py-3 rounded-xl font-bold text-indigo-600 bg-white shadow-lg">📊 族群分析</button>
                <button onclick="showView('individual')" class="px-6 py-3 rounded-xl font-bold text-slate-600 hover:text-indigo-600 bg-slate-50">👤 個人報告</button>
                <button onclick="showView('entry')" class="px-6 py-3 rounded-xl font-bold text-slate-600 hover:text-indigo-600 bg-slate-50">➕ 資料錄入</button>
            </div>
        </div>
    </header>

    <!-- 族群分析 -->
    <div id="dashboard" class="view space-y-6">
        <div class="bg-white p-6 rounded-2xl shadow-lg border-l-4 border-indigo-500">
            <h2 class="text-2xl font-bold text-slate-800 mb-6">📈 族群健康警示</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="text-center p-6 bg-gradient-to-br from-red-50 to-pink-50 rounded-xl border">
                    <div class="text-3xl font-black text-red-600 mb-1">12</div>
                    <div class="text-sm text-slate-600 font-bold">肥胖警示<br><span class="text-xs text-red-500">(BMI ≥ 27)</span></div>
                </div>
                <div class="text-center p-6 bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl border">
                    <div class="text-3xl font-black text-orange-600 mb-1">8</div>
                    <div class="text-sm text-slate-600 font-bold">內臟脂肪高<br><span class="text-xs text-orange-500">(VF ≥ 10)</span></div>
                </div>
                <div class="text-center p-6 bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl border">
                    <div class="text-3xl font-black text-amber-600 mb-1">15</div>
                    <div class="text-sm text-slate-600 font-bold">骨骼肌率低</div>
                </div>
                <div class="text-center p-6 bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl border">
                    <div class="text-3xl font-black text-rose-600 mb-1">6</div>
                    <div class="text-sm text-slate-600 font-bold">肌少症風險</div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="bg-white p-8 rounded-2xl shadow-lg border">
                <h3 class="text-xl font-bold text-slate-700 mb-4">👥 族群概況</h3>
                <div class="space-y-4 text-center">
                    <div><span class="text-3xl font-black text-indigo-600">23</span><div class="text-sm text-slate-500">總人數</div></div>
                    <div><span class="text-3xl font-black text-blue-600">14 / 9</span><div class="text-sm text-slate-500">男/女</div></div>
                    <div><span class="text-3xl font-black text-emerald-600">58.2</span><div class="text-sm text-slate-500">平均年齡</div></div>
                </div>
            </div>
            <div class="lg:col-span-2 bg-white p-8 rounded-2xl shadow-lg border">
                <h3 class="text-xl font-bold text-slate-700 mb-6">📊 趨勢圖表</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 h-64 bg-slate-50 rounded-xl flex items-center justify-center">
                    <div class="text-center p-8">
                        <div class="w-24 h-24 bg-gradient-to-r from-indigo-400 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center">
                            <span class="text-2xl font-bold text-white">📈</span>
                        </div>
                        <h4 class="font-bold text-lg mb-2">身體組成改善</h4>
                        <p class="text-3xl font-black text-emerald-600">+12.5%</p>
                        <p class="text-sm text-slate-500">過去3個月</p>
                    </div>
                    <div class="text-center p-8">
                        <div class="w-24 h-24 bg-gradient-to-r from-emerald-400 to-teal-500 rounded-full mx-auto mb-4 flex items-center justify-center">
                            <span class="text-2xl font-bold text-white">🏃</span>
                        </div>
                        <h4 class="font-bold text-lg mb-2">心肺功能提升</h4>
                        <p class="text-3xl font-black text-indigo-600">+18%</p>
                        <p class="text-sm text-slate-500">6分鐘行走距離</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 個人報告 -->
    <div id="individual" class="view hidden">
        <div class="bg-white p-8 rounded-3xl shadow-xl border max-w-4xl mx-auto">
            <div class="flex justify-between items-start mb-8">
                <div>
                    <h2 class="text-4xl font-black bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent mb-2">王大明</h2>
                    <p class="text-xl text-slate-500">39歲 | 男 | 最新評估：2024-12-20</p>
                </div>
                <button onclick="window.print()" class="bg-indigo-600 text-white px-8 py-4 rounded-2xl font-bold shadow-lg hover:bg-indigo-700 flex items-center gap-3">
                    <span>📄</span> 列印報告
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-2xl font-bold text-indigo-600 mb-6 border-b pb-3">📏 身體組成</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between p-4 bg-slate-50 rounded-xl">
                            <span class="font-bold">BMI</span>
                            <div class="text-right">
                                <div class="text-2xl font-black text-red-600">25.8</div>
                                <div class="text-sm text-red-500">高於標準</div>
                            </div>
                        </div>
                        <div class="flex justify-between p-4 bg-slate-50 rounded-xl">
                            <span class="font-bold">體脂率</span>
                            <div class="text-right">
                                <div class="text-2xl font-black text-red-600">22.5%</div>
                                <div class="text-sm text-red-500">高於標準</div>
                            </div>
                        </div>
                        <div class="flex justify-between p-4 bg-slate-50 rounded-xl">
                            <span class="font-bold">骨骼肌率</span>
                            <div class="text-right">
                                <div class="text-2xl font-black text-emerald-600">32.1%</div>
                                <div class="text-sm text-emerald-500">標準</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-emerald-600 mb-6 border-b pb-3">🏃 體能表現</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between p-4 bg-emerald-50 rounded-xl border-l-4 border-emerald-500">
                            <span class="font-bold">一分鐘仰臥起坐</span>
                            <div class="text-right">
                                <div class="text-2xl font-black text-blue-600">28次</div>
                                <div class="text-sm text-blue-500">適當</div>
                            </div>
                        </div>
                        <div class="flex justify-between p-4 bg-emerald-50 rounded-xl border-l-4 border-emerald-500">
                            <span class="font-bold">6分鐘行走</span>
                            <div class="text-right">
                                <div class="text-2xl font-black text-emerald-600">465m</div>
                                <div class="text-sm text-emerald-500">標準</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 資料錄入 -->
    <div id="entry" class="view hidden max-w-3xl mx-auto space-y-6">
        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-8 rounded-3xl shadow-2xl text-center">
            <h2 class="text-3xl font-black mb-2">➕ 新增評估資料</h2>
            <p class="opacity-90">請填寫完整資料後複製到 Google Sheets</p>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border">
            <h3 class="text-xl font-bold text-slate-700 mb-6">👤 基本資料</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div><label class="block text-sm font-bold text-slate-500 mb-2">床號</label><input type="text" id="bed" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500" placeholder="A01"></div>
                <div><label class="block text-sm font-bold text-slate-500 mb-2">姓名</label><input type="text" id="name" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500" placeholder="王大明"></div>
                <div><label class="block text-sm font-bold text-slate-500 mb-2">出生日期</label><input type="date" id="birthday" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500"></div>
                <div><label class="block text-sm font-bold text-slate-500 mb-2">性別</label>
                    <select id="gender" class="w-full p-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500">
                        <option>男</option>
                        <option>女</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border">
            <h3 class="text-xl font-bold text-slate-700 mb-6">📏 身體測量</h3>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                <div><label class="block text-xs text-slate-500 mb-1">身高(cm)</label><input type="number" id="height" class="w-full p-3 border rounded-lg" placeholder="175"></div>
                <div><label class="block text-xs text-slate-500 mb-1">體重(kg)</label><input type="number" id="weight" class="w-full p-3 border rounded-lg" placeholder="75"></div>
                <div><label class="block text-xs text-slate-500 mb-1">體脂(%)</label><input type="number" id="bodyFat" class="w-full p-3 border rounded-lg" placeholder="21"></div>
                <div><label class="block text-xs text-slate-500 mb-1">骨骼肌(%)</label><input type="number" id="sMM" class="w-full p-3 border rounded-lg" placeholder="33"></div>
                <div><label class="block text-xs text-slate-500 mb-1">內臟脂肪</label><input type="number" id="visceralFat" class="w-full p-3 border rounded-lg" placeholder="9"></div>
            </div>
        </div>

        <div class="bg-white p-8 rounded-2xl shadow-lg border">
            <h3 class="text-xl font-bold text-slate-700 mb-6">🏃 體能測試</h3>
            <div class="grid grid-cols-2 gap-4">
                <div><label class="block text-xs text-slate-500 mb-1">仰臥起坐(次)</label><input type="number" id="situps" class="w-full p-3 border rounded-lg" placeholder="18"></div>
                <div><label class="block text-xs text-slate-500 mb-1">6分鐘行走(m)</label><input type="number" id="walk6m" class="w-full p-3 border rounded-lg" placeholder="450"></div>
                <div><label class="block text-xs text-slate-500 mb-1">30秒坐站(次)</label><input type="number" id="sitStand" class="w-full p-3 border rounded-lg" placeholder="18"></div>
                <div><label class="block text-xs text-slate-500 mb-1">坐姿前屈(cm)</label><input type="number" id="sitReach" class="w-full p-3 border rounded-lg" placeholder="12"></div>
            </div>
        </div>

        <button onclick="generateCSV()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6 rounded-3xl font-black text-xl shadow-2xl hover:scale-105 transition-all duration-200">
            📋 複製 CSV 到 Google Sheets
        </button>
    </div>

    <script>
        function showView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById(viewName).classList.remove('hidden');
        }

        function generateCSV() {
            const data = {
                id: document.getElementById('bed').value.slice(0,3) || '001',
                bed: document.getElementById('bed').value,
                name: document.getElementById('name').value,
                gender: document.getElementById('gender').value,
                birthday: document.getElementById('birthday').value,
                date: new Date().toISOString().split('T')[0],
                weight: document.getElementById('weight').value,
                height: document.getElementById('height').value,
                bodyFat: document.getElementById('bodyFat').value,
                sMM: document.getElementById('sMM').value,
                visceralFat: document.getElementById('visceralFat').value,
                sitStand: document.getElementById('sitStand').value,
                walk6m: document.getElementById('walk6m').value,
                sitReach: document.getElementById('sitReach').value,
                situps: document.getElementById('situps').value,
                waist: '88', hip: '90', bmr: '1720', bodyAge: '38'
            };

            const csv = Object.values(data).join(',');
            navigator.clipboard.writeText(csv).then(() => {
                alert('✅ 已複製到剪貼簿！\n請貼到 Google Sheets 第2列開始');
            });
        }

        // 預設顯示第一個頁面
        showView('dashboard');
    </script>

    <style>
        .view { min-height: 70vh; }
        @media print {
            body * { visibility: hidden; }
            #individual, #individual * { visibility: visible; }
            #individual { position: absolute; left: 0; top: 0; width: 100%; }
        }
    </style>
</body>
</html>
